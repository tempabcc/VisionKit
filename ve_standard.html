<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VePlayer 标准模式 - VisionKit</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/@arco-design/web-vue@latest/dist/arco-vue.min.js"></script>
    <script src="https://unpkg.com/@arco-design/web-vue@latest/dist/arco-vue-icon.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/@arco-design/web-vue@latest/dist/arco.css">
    <link rel="stylesheet" href="https://lf-unpkg.volccdn.com/obj/vcloudfe/sdk/@volcengine/veplayer/1.10.0/index.min.css" />
    <script src="https://lf-unpkg.volccdn.com/obj/vcloudfe/sdk/@volcengine/veplayer/1.10.0/index.min.js"></script>
    <style>
        body { background-color: #17171a; color: #fff; }
        .player-wrapper {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            border-radius: 4px;
            overflow: hidden;
            background: #000;
        }
    </style>
</head>
<body arco-theme="dark">
    <div id="app">
        <a-layout style="min-height: 100vh; background: #17171a;">
            <a-page-header
                style="background: #232324; border-bottom: 1px solid #333;"
                title="VePlayer 标准模式"
                subtitle="沉浸式暗色体验"
                @back="goBack"
            >
                <template #back-icon>
                    <icon-left style="color: #fff;" />
                </template>
            </a-page-header>
            <a-layout-content style="padding: 48px 24px; display: flex; justify-content: center; align-items: flex-start;">
                <div v-if="hasSource" class="player-wrapper">
                    <div id="veplayer-container"></div>
                </div>
                <div v-else style="margin-top: 100px;">
                    <a-empty>
                        <template #description>
                            <span style="color: rgba(255,255,255,0.7);">请在 URL 中指定 src 参数</span>
                        </template>
                    </a-empty>
                </div>
            </a-layout-content>
        </a-layout>
    </div>

    <script>
        const { createApp } = Vue;
        const { Message } = ArcoVue;

        const App = {
            data() {
                return {
                    hasSource: false,
                    playerInstance: null
                };
            },
            mounted() {
                const params = new URLSearchParams(window.location.search);
                const src = params.get('src');
                const isLive = params.has('zhibo');

                if (src) {
                    this.hasSource = true;
                    // Slight delay to ensure DOM is ready for VePlayer
                    setTimeout(() => {
                        try {
                            if (window.playerInstance) {
                                window.playerInstance.destroy();
                            }
                            window.playerInstance = new VePlayer({
                                id: 'veplayer-container',
                                width: '100%',
                                height: '100%', // Container controls height
                                url: src,
                                isLive: isLive,
                                controls: true,
                                autoplay: true,
                                fluid: true, // Responsive
                                vodLogOpts: {
                                    line_app_id: 1, // 00000001
                                    tag: '普通视频'
                                }
                            });
                            this.playerInstance = window.playerInstance;
                        } catch (e) {
                            console.error(e);
                            Message.error('播放器初始化失败');
                        }
                    }, 100);
                }
            },
            methods: {
                goBack() {
                    window.location.href = 'index.html';
                }
            }
        };

        const app = createApp(App);
        app.use(ArcoVue);
        app.use(ArcoVueIcon);
        app.mount('#app');
    </script>
</body>
</html>
