<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VePlayer 标准模式 - VisionKit</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/@arco-design/web-react@latest/dist/css/arco.min.css">
    <script src="https://unpkg.com/@arco-design/web-react@latest/dist/arco.min.js"></script>
    <script src="https://unpkg.com/@arco-design/web-react@latest/dist/arco-icon.min.js"></script>
    <link rel="stylesheet" href="https://lf-unpkg.volccdn.com/obj/vcloudfe/sdk/@volcengine/veplayer/1.10.0/index.min.css" />
    <script src="https://lf-unpkg.volccdn.com/obj/vcloudfe/sdk/@volcengine/veplayer/1.10.0/index.min.js"></script>
    <style>
        body { background-color: #17171a; color: #fff; }
        .player-wrapper {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            border-radius: 4px;
            overflow: hidden;
            background: #000;
        }
    </style>
</head>
<body arco-theme="dark">
    <div id="root"></div>

    <script type="text/babel">
        const { Layout, Button, PageHeader, Message, Empty } = arco;
        const { Content } = Layout;
        const { IconLeft } = arcoicon;

        function App() {
            const playerRef = React.useRef(null);
            const [hasSource, setHasSource] = React.useState(false);

            React.useEffect(() => {
                const params = new URLSearchParams(window.location.search);
                const src = params.get('src');
                const isLive = params.has('zhibo');

                if (src) {
                    setHasSource(true);
                    // Slight delay to ensure DOM is ready for VePlayer
                    setTimeout(() => {
                        try {
                            if (window.playerInstance) {
                                window.playerInstance.destroy();
                            }
                            window.playerInstance = new VePlayer({
                                id: 'veplayer-container',
                                width: '100%',
                                height: '100%', // Container controls height
                                url: src,
                                isLive: isLive,
                                controls: true,
                                autoplay: true,
                                fluid: true, // Responsive
                                vodLogOpts: {
                                    line_app_id: 1, // 00000001
                                    tag: '普通视频'
                                }
                            });
                        } catch (e) {
                            console.error(e);
                            Message.error('播放器初始化失败');
                        }
                    }, 100);
                }
            }, []);

            return (
                <Layout style={{ minHeight: '100vh', background: '#17171a' }}>
                    <PageHeader
                        style={{ background: '#232324', borderBottom: '1px solid #333' }}
                        title="VePlayer 标准模式"
                        subTitle="沉浸式暗色体验"
                        backIcon={<IconLeft style={{ color: '#fff' }} />}
                        onBack={() => window.location.href = 'index.html'}
                    />
                    <Content style={{ padding: '48px 24px', display: 'flex', justifyContent: 'center', alignItems: 'flex-start' }}>
                        {hasSource ? (
                            <div className="player-wrapper">
                                <div id="veplayer-container"></div>
                            </div>
                        ) : (
                            <div style={{ marginTop: 100 }}>
                                <Empty 
                                    description={<span style={{ color: 'rgba(255,255,255,0.7)' }}>请在 URL 中指定 src 参数</span>} 
                                />
                            </div>
                        )}
                    </Content>
                </Layout>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
